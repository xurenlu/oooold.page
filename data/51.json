{"title":"价格过滤","zzzContent":"#价格过滤\n\n\n 价格过滤有4个概念:\n\n1. 用户筛选\n1. QP推荐\n1. 反作弊\n1. 个性化价格过滤\n\n### 价格过滤\n价格过滤是指用户在筛选区手工输入数字 ,或是点击了流行价格区间之后产生的过滤.表现在URL 中会有filter=reserve_rice[10,100] 这样的参数 ;\n\t\n### QP推荐\nQP推荐,是指QP根据当前query的语义推荐的价格限制,比如搜索\"500元以上的手表\"等;\n\t数据记录在QP返回的ruletmpl 这个模块下,用<start_price>1000</start_price>或<end_price>10000</end_price>这些标签来声明.\n\t\n### 反作弊\n\n反作弊团队根据业务需求,对部分商品进行了价格限制,比如LV,劳力士这些词,不做限制则出来的全部是假货;\n数据记录在QP返回的spam模块中,<pricelimit>1000</pricelimit>这里;\n\t\n\t\n### 个性化价格过滤\t\n\n个性化价格过滤,是指QP根据当前用户的购买力,个性化推荐了一个价格筛选,在引擎层自动生效,这时生效的值需要我们透知给用户;比如,高富帅A搜索西装,出现的价格就是300元以的,而普通用户,可能这个值就是100元以上;\n\t这个值记录在sp返回的\"auxiliary\"里:\n\t\n\t\"auxiliary\": \n\t{\n\t\t\"navigator_type\": [\n\t\t\t\"3\"\n\t\t]\t,\n\t\t\"price_filter\": [\n\t\t\t\"price_limit:48\",\n\t\t\t\"\"\n\t\t],\n\t\t...\n\t}\n个性化价格过滤只在价格排序和销量,信用排序下生效;\n\n\n### 优先级:\n如果用户进行了任何价格筛选,则qp推荐的价格筛选不生效,启用用户手工筛选的最高价和最低价;\n如果反作弊设置了最低价,则用户筛选和qp推的最低价都不可以低于这个反作弊的最低价;\n\n\n## 方法调用:\n\n个性化过滤只需要展示给用户即可,请参照PriceLimitModule的实现;\n其余的逻辑都在PriceHelper里有实现:\n  取最终生效的价格上下限,用getPriceStart/getPriceEnd , 这两个方法需要传两个参数 ,不想记log的话viewLogger参数可传null即可.","postDate":"2018-01-01 02:03:36","postId":51,"type":"post","status":"publish","imported":false,"file":"价格过滤.md"}