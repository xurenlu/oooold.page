{"title":"ssh_with_boot2docker","zzzContent":"http://stackoverflow.com/questions/23014684/how-to-get-ssh-connection-with-docker-container-on-osxboot2docker\n\nThere are several things you must do to enable ssh'ing to a container running in a VM:\n\ninstall and run sshd in your container (example). sshd is not there by default because containers typically run only one process, though they can run as many as you like.\nEXPOSE a port as part of creating the image, typically 22, so that when you run the container, the daemon connects to the EXPOSE'd port inside the container and something can be exposed on the outside of the container.\nWhen you run the container, you need to decide how to map that port. You can let Docker do it automatically or be explicit. I'd suggest being explicit: docker run -p 42222:22 ... which maps port 42222 on the VM to port 22 in the container.\nAdd a portmap to the VM to expose the port to your host. e.g. when your VM is not running, you can add a mapping like this: VBoxManage modifyvm \"boot2docker-vm\" --natpf1 \"containerssh,tcp,,42222,,42222\"\nThen from your host, you should be able to ssh to port 42222 on the host to reach the container's ssh daemon.\n\nHere's what happens when I perform the above steps:\n\n\n\n\n\n# sshd\n#\n# VERSION               0.0.1\n\nFROM     ubuntu \nMAINTAINER Thatcher R. Peskens \"thatcher@dotcloud.com\"\n\n# make sure the package repository is up to date\nRUN echo \"deb http://archive.ubuntu.com/ubuntu precise main universe\" > /etc/apt/sources.list\nRUN apt-get update\n\nRUN apt-get install -y openssh-server\nRUN mkdir /var/run/sshd \nRUN echo 'root:screencast' |chpasswd\n\nEXPOSE 22\nCMD    /usr/sbin/sshd -D\n\n\n\nVBoxManage modifyvm \"boot2docker-vm\" --natpf1 \"containerssh,tcp,,42222,,42222\"\n$ ./boot2docker start\n[2014-04-11 12:07:35] Starting boot2docker-vm...\n[2014-04-11 12:07:55] Started.\n$ docker run -d -p 42222:22 dhrp/sshd\nUnable to find image 'dhrp/sshd' (tag: latest) locally\nPulling repository dhrp/sshd\n2bbfe079a942: Download complete \nc8a2228805bc: Download complete \n8dbd9e392a96: Download complete \n11d214c1b26a: Download complete \n27cf78414709: Download complete \nb750fe79269d: Download complete \ncf7e766468fc: Download complete \n082189640622: Download complete \nfa822d12ee30: Download complete \n1522e919ec9f: Download complete \nfa594d99163a: Download complete \n1bd442970c79: Download complete \n0fda9de88c63: Download complete \n86e22a5fdce6: Download complete \n79d05cb13124: Download complete \nac72e4b531bc: Download complete \n26e4b94e5a13b4bb924ef57548bb17ba03444ca003128092b5fbe344110f2e4c\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                   NAMES\n26e4b94e5a13        dhrp/sshd:latest    /usr/sbin/sshd -D      6 seconds ago       Up 3 seconds        0.0.0.0:42222->22/tcp   loving_einstein     \n$ ssh root@localhost -p 42222\nThe authenticity of host '[localhost]:42222 ([127.0.0.1]:42222)' can't be established.\nRSA key fingerprint is ....\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '[localhost]:42222' (RSA) to the list of known hosts.\nroot@localhost's password: screencast\nWelcome to Ubuntu 12.04 LTS (GNU/Linux 3.12.1-tinycore64 x86_64)\n\n * Documentation:  https://help.ubuntu.com/\n\nThe programs included with the Ubuntu system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\n\nroot@26e4b94e5a13:~# exit\n\n\n\nSo that shows ssh->localhost 42222->VM port 42222->container port 22.","postDate":"2018-01-01 02:03:35","postId":34,"type":"post","status":"publish","imported":false,"file":"ssh_with_boot2docker.md"}